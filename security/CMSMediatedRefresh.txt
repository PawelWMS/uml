/*
@startuml
autonumber
title Device to Device Key Refresh Example\n Using a Credential Provisioning Service
participant "Device-1" as D1
participant "Device-2" as D2
participant "Credential Provisioning Service" as CPS

==Device-1 Orchestrates Provisioning of Credential Refresh ==
note over D1, CPS
Device-1 uses a credential provisioning service to refresh a pre-shared key on Device-2.
end note
D1->D2: Attempt DTLS connection with D2 but credential is refused. 
D1->CPS: Open a DTLS session with CPS
D1->CPS: GET /oic/sec/cred?"DeviceID"="uuidD2"
CPS->CPS: Generate pairwise key PSK for D1 and D2.
CPS->D1: RSP [{...,"DeviceID"="uuidD2",...,"PrivateData":"PSK",...}]
D1->CPS: Close DTLS session.
note over D1, D2
Device-1 signals Device-2 to request credential provisioning.
end note
D1->D2: PUT /oic/sec/cred [{...,"DeviceID":"uuidD1", "PrivateData":" ",...}]
D2->D1: RSP 2.01
D2->CPS: Open a DTLS session with CPS
D2->CPS: GET /oic/sec/cred?"DeviceID"="uuidD1"
CPS->D2: RSP [{...,"DeviceID"="uuidD1",...,"PrivateData":"PSK",...}]
D2->CPS: Close DTLS session.
note over D1, D2
Device-2 signals Device-1 that credentials are established by opening a DTLS session.
end note
D2->D1: Open DTLS session.
D1->D2: Do something.
D1<->D2: Close DTLS session.
@enduml
*/